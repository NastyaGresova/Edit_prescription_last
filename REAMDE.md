# Инструкция для проекта "Edit_prescription"

В проекте Edit_prescription лежат тесты для проверки функционала, связанного с редактированием амбулаторного назначения а также созданием амбулаторных назначений со сложными схемами приемами. Вот описание каждого из тестов:

* Calculator_scheme_Then_X_Days *- создание простого назначения из глоссария со схемой приема вида: обычная схема + Затем через Х дней + калькулятор*
* Create_Simple *- создать простое назначение из глоссария, открыть его на просмотр*
* Context_menu_scheme *- создать простое назначение из глоссария, добавить схему приема из контекстного меню медикамента*
* Create_Complex *- создать составное назначение, открыть его на просмотр*
* Create_Typical *- добавить типовое назначение*
* Typical_scheme *- создать простое назначение из глоссария, добавить схему приема из списка типовых схем*
* Calculator_scheme *- создать простое назначение из глоссария, набрать схему приема на калькуляторе*
* Calculator_scheme_Then *- создание простого назначения из глоссария со схемой приема вида: обычная схема + Затем + калькулятор*
* Calculator_and_Typical_scheme *- создание простого назначения из глоссария со схемой приема вида: калькулятор + Затем + типовая схема*
* Scheme_edit *- создание простого назначения из глоссария, редактирование схемы приема в окне-редакторе назначения*

## Чтобы запустить проект на своем компьютере, нужно выполнить 3 следующие инструкции ##

> ### 1. Нужно создать подключение к БД
>
>> ##### **1.1.** Windows -> Панель управления -> Администрирование -> Источники данных (ODBC):
>> ![Источники данных (ODBC)](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db_1.PNG)
>> 
>> ##### 1.2. В окне "Создание нового источника данных" выбрать "ODBC Driver 17 for SQL Server":
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db2.PNG)
>> 
>> ##### 1.3. В окне "Создание источника данных для SQL Server" заполнить имя для источника данных и выбрать нужный сервер:
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db3.PNG)
>> 
>> ##### 1.4. Далее выбрать пункт "проверка подлинности учетной записи SQL Server" и ввести имя пользователя и пароль:
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db4.PNG)
>> 
>> ##### 1.5. Проставить галочку "Использовать по умолчанию базу данных" и выбрать базу данных, к которой нужно подключаться:
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db5.PNG)
>> 
>> ##### 1.6. На следующем этапе ничего не меняем, нажимаем на кнопку "Готово":
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db6.PNG)
>> 
>> ##### 1.7. В окне "Установка ODBC для Microsoft SQL Server" нажать на кнопку "Проверить источник данных...":
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db7.PNG)
>> 
>> ##### 1.8. Если все ок, то получаем такой результат:
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/connection_db8.PNG)


> ### 2.  Теперь нужно выполнить некоторые настройки в Медиалоге
>
>> #### 2.1. Настроить модели поиска в соответствии с тем, как указано на скриншотах
>>
>>> ##### 2.1.1. В глоссарии для объекта "Амбулаторные назначения", вкладка "Список"
>>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/base_tests_gloss_simple.PNG)
>>>
>>> ##### 2.1.2. В глоссарии для объекта "Амбулаторные назначения", вкладка "Типовые"
>>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/base_tests_gloss_typical.PNG)
>>>
>>> ##### 2.1.3. В глоссарии для объекта "Амбулаторные назначения", в части с калькулятором и типовыми схемами приема
>>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/templates_gloss.png)
>>
>> #### 2.2. В проекте "Edit_prescription" способ введения в назначение добавляется двойным кликом из глоссария, поэтому нужно учесть, что глоссарий со способами введения не должен быть пустым
>> ![Имя изображения](https://github.com/NastyaGresova/HelloWorld/blob/main/base_tests_gloss_intake_methods.PNG)
>>
>> #### 2.3. Системные параметры PR_TEMPLATES_SIMPLE_DEFAULT и PR_TEMPLATES_MULTIPLE_DEFAULT должны быть заполнены. Схемы в системных параметрах могут быть любыми.
>>
> ### 3. Нужно настроить переменные в файле Unit_var.sj

Сейчас в файле Unit_var.sj настроены переменные для следующих тестовых баз:
* \\SQL-SERVER\CLIENTS_BASE\TESTIROVANYE\ALL\TESTERS_800_DEV_BTK
* \\Sql-server2019\clients_base\TESTIROVANYE\ALL\Testers_810_DEV_Collection_7DF
* \\SQL-SERVER2019\CLIENTS_BASE\TESTIROVANYE\ALL\TESTERS_810_4_COLLECTION_7DF

Для того, чтобы запустить проект, нужно в файле Unit_var.sj оставить переменные для базы, на которой будут проводиться тесты, а остальные переменные закомментировать.
Можно не изменять переменные в файле, тогда тесты будут проходить по одним и тем же значениям (под значениями имеются ввиду медикаменты, схема приема, способ введения и т.д.). Но для того, чтобы тесты прогонялись по разным значениям, переменные нужно менять. 
Файл Unit_var.sj разделен на три блока:
* переменные для работы на базе \\SQL-SERVER\CLIENTS_BASE\TESTIROVANYE\ALL\TESTERS_800_DEV_BTK
* переменные для работы на базе \\Sql-server2019\clients_base\TESTIROVANYE\ALL\Testers_810_DEV_Collection_7DF
* переменные для работы на базе \\SQL-SERVER2019\CLIENTS_BASE\TESTIROVANYE\ALL\TESTERS_810_4_COLLECTION_7DF


Чтобы изменить переменные, выберем один из блоков. Например, возьмем переменные для работы на базе \\SQL-SERVER\CLIENTS_BASE\TESTIROVANYE\ALL\TESTERS_800_DEV_BTK. 
В первой части этого блока находится список переменных. Далее идут различные функции. Функции менять не нужно.

var w0_var=Sys.Process("Automedi");  *- переменную w0_var менять не нужно, это сам процесс Automedi, он везде одинаковый*

var version = 5;  *- номер версии, для DEV-версии version = 5, а для пользовательской версии version = 4*

var patients_id_var = 535828; *- id пациента, на котором проводятся тесты*

var comment = 1; *- флажок: нужен ли комментарий при создании назначения: 0 - нет , 1 - да*

var comment_text = "1239e9qewioJSOWIE"; *- текст комментария*

var pr_drugs_id_var = 3790;   *- id основного медикамента, этот медикамент будет использоваться в большей части тестов*

var scheme_name="test test"; *- название схемы приема из контекстного меню медикамента*

var pr_drugs_id_list = [434, 436, 463, 442]; *- id медикаментов, на основе которых делается составное назначение* 

var pr_templates_id_var = 216; *- id типовой схемы приема*

var intake_method_i_var = 2; *- просто порядковый номер способа введения из глоссария*

var dose_calc_var = 13.56; *- дозировка приема для ввода в калькулятор*

var duration_var = 5;  *- длительность назначения (дней, месяцев и т.д.)*

var break_between_schemes_var = 7; *- перерыв между схемами в днях*

var pr_drugs_id_composite_mnn = 620; *- id медикамента со сложным МНН*

var pr_template_schemes_id=4208; *- id типового назначения* 

